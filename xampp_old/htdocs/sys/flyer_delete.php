<?php  /**   *  This page displays the flyer editor page of the admin section.   *   *  Language is hardcoded Hungarian, others are not required.   */  if(!loggedin() || !isauth())  {    redirect_in_site("?page=$default_page&lang=$lang");  }  else  {      if (isset($_SESSION['flyers']))    {      /// Print the list of pages in the currently edited flyer, and menus for each page.      $flyers = "<table>";      for ($i = 0; $i < $_SESSION['flyers']['pagecount']; $i++)        $flyers .= '<tr><td>' . get_flyer_table($_SESSION['flyers'][$i]) . '</td><td style="vertical-align:top">' .                    (floor($i/2) + 1) . '. oldal ' . (($i % 2 == 1) ? 'hátulja' : 'eleje') . '<br />' .                   '<a href="?page=flyer_editor_' . $_SESSION['flyers'][$i]['pagetype'] . '&lang=hun&pageid=' . $i . '">oldal szerkesztése</a><br />' .                    '<a href="#" onClick="remove_page(' . $i . ');window.location.reload();">oldal törlése</a></td></tr>';      $flyers .= "</table>";            if ($_SESSION['flyer_changed'])        $warn = 'A prospektus még nincs elmentve! Ha most kilép elveszti az összes módosítást. A változások megőrzéséhez kattintson a "Mentés" feliratra.';              if (is_file('saved_flyers/' . $_SESSION['flyer_title'] . '.pdf'))      {        $lastsavedpdf = 'A prospektus legutóbbi mentett példánya itt érhetõ el:<br />' .                         '<a href="https://'.($_SERVER['HTTP_HOST']).'/saved_flyers/' . $_SESSION['flyer_title'] . '.pdf">https://'.($_SERVER['HTTP_HOST']).'/saved_flyers/' . $_SESSION['flyer_title'] . '.pdf</a><br />';      }            $filemenu = '<table><tr><td><a href="sys/flyer_save.php"><div style="text-align:center; height:50px; width:60px; cursor:pointer; cursor:hand;"><img src="img/flyer/filesave.png" style="border-style:none" /><br />Mentés</div></a></td>' .                   '<td><a href="sys/flyer_close.php"><div style="text-align:center; height:50px; width:60px; cursor:pointer; cursor:hand;"><img src="img/flyer/fileclose.png" style="border-style:none" /><br />Bezárás</div></a></td>' .                   '<td><a href="sys/flyer_createpdf.php?flyer_lang=eng"><div style="text-align:center; height:50px; width:60px; cursor:pointer; cursor:hand;"><img src="img/flyer/fileprint.png" style="border-style:none" /><br />Nyomtatás angolul</div></a></td>' .                   '<td><a href="sys/flyer_createpdf.php?flyer_lang=hun"><div style="text-align:center; height:50px; width:60px; cursor:pointer; cursor:hand;"><img src="img/flyer/fileprint.png" style="border-style:none" /><br />Nyomtatás magyarul</div></a></td>' .                   '<td><a href="#frmNewPage" class="highslide" onclick="return hs.htmlExpand(this, {contentId: \'frmNewPage\', align: \'center\'}, {onClosed: function(){window.location.reload();}});" border="0"><div style="text-align:center; height:50px; width:100px; cursor:pointer; cursor:hand;"><img src="img/flyer/edit_add.png" style="border-style:none" /><br />Oldal hozzáadása</div></a></td>' .                   '<td><a href="#frmSetTitle" class="highslide" onclick="return hs.htmlExpand(this, {contentId: \'frmSetTitle\', align: \'center\'}, {onClosed: function(){window.location.reload();}});" border="0"><div style="text-align:center; height:50px; width:100px; cursor:pointer; cursor:hand;"><img src="img/flyer/filesaveas.png" style="border-style:none" /><br />Név megadása</div></a></td></tr></table>';      $flyer_title = isset($_SESSION['flyer_title']) ? ' (' . $_SESSION['flyer_title'] . ')' : " (névtelen)";    }    else    {      /// Load the list of flyers      $flyers = "<table>";            $mysql = get_connection();      $mysql->execute($sql['setutf']);      $stmt  = $mysql->prepare($sql['flyer:get_flyers']);      if($stmt->execute())      {        $flyer_list = $stmt->fetch_all();        $c = $stmt->num_rows();                for ($i = 0; $i < $c; $i++)          $flyers .= '<tr><td style="width:200px">' . $flyer_list[$i]['flyer_title'] . '</td><td><a href="sys/flyer_open.php?id=' . $flyer_list[$i]['flyer_id'] . '"><div style="text-align:center; height:48px; width:60px;"><img src="img/flyer/fileopen.png" style="border-style:none" /><br />Megnyitás</div></a></td></tr>';                $flyers .= "</table>";      }            $warn = '';            $filemenu = '<a href="sys/flyer_new.php" style="margin-right:10px"><div style="text-align:center; height:40px; width:80px;"><img src="img/flyer/filenew.png" style="border-style:none" /><br />Új szórólap</div></a>';      $flyer_title = '';    }            /// Start outputting the page.    $template = new Template();        $variables = array(                   "FLYERS" => $flyers,                   "WARN" => $warn,                   "LASTSAVEDPDF" => $lastsavedpdf,                   "FILEMENU" => $filemenu,                   "FLYER_TITLE" => $flyer_title);    $template->assign_var_array($variables);        $main_content = $template->compile("sys/lang/hun/flyer_editor");  //WARNING: Language hardcoded, no other languages needed        include("sys/tpl/main.tpl");  }?>